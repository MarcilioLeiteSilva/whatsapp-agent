{% extends "base.html" %}
{% block title %}Regras • {{ agent.name }}{% endblock %}

{% block content %}
  <div class="flex items-start justify-between gap-4 flex-col md:flex-row">
    <div>
      <h1 class="text-2xl font-bold">Regras do agente</h1>
      <p class="text-sm text-slate-600">
        {{ agent.name }} • <span class="font-mono text-xs">{{ agent.instance }}</span> • {{ agent.client_name }}
      </p>
    </div>

    <div class="flex gap-2">
      <a href="{{ back_url }}" class="h-10 inline-flex items-center px-4 rounded-xl bg-white shadow-soft text-slate-900 text-sm font-semibold hover:bg-slate-50">
        Voltar
      </a>
    </div>
  </div>

  <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="lg:col-span-2 bg-white rounded-2xl shadow-soft p-5">
      <h2 class="font-bold">rules_json (JSONB)</h2>
      <p class="mt-1 text-sm text-slate-600">Cole/edite o JSON e salve. O cache será invalidado automaticamente.</p>

      <form class="mt-4 space-y-3" method="post" action="{{ save_action }}">
        <textarea name="rules_text" rows="22"
                  class="w-full rounded-2xl border border-slate-200 px-4 py-3 font-mono text-xs outline-none focus:ring-2 focus:ring-indigo-200">{{ rules_text }}</textarea>

        <div class="flex gap-2">
          <button class="h-11 px-4 rounded-2xl bg-slate-900 text-white font-semibold hover:bg-slate-800">
            Salvar regras
          </button>
        </div>
      </form>
    </div>

    <div class="bg-white rounded-2xl shadow-soft p-5">
      <h2 class="font-bold">Ações</h2>
      <p class="mt-1 text-sm text-slate-600">Bootstrap rápido e reset.</p>

      <form method="post" action="{{ reset_action }}" class="mt-4">
        <button class="w-full h-11 rounded-2xl bg-rose-600 text-white font-semibold hover:bg-rose-700">
          Resetar para template básico
        </button>
      </form>

      <div class="mt-6 p-4 rounded-2xl bg-slate-50 border border-slate-200">
        <div class="text-xs text-slate-500">Agente</div>
        <div class="mt-1 text-sm font-semibold">{{ agent.id }}</div>
        <div class="mt-1 text-xs text-slate-600">status: {{ agent.status }}</div>
      </div>
    </div>
  </div>
{% endblock %}
